"ScrnPrchsOrdrRqst As screen.'teamsHeroApp_ver1.0'":
    LoadingSpinnerColor: =RGBA(98, 100, 167, 1)
    OnVisible: |
        =UpdateContext(
            {
                varStyle: {
                    topBarHeight: 52,
                    topBarTitleSize: 12,
                    topBarTitleLeftPadding: 12,
                    topBarIconRightPadding: 12,
                    topBarTitleLeftPaddingWithButton: 8,
                    iconSize: 16,
                    largeIconSize: 35,
                    iconPadding: 6,
                    spaceBetweenIcons: 4,
                    deletePageSideMargins: 200,
                    galleryBarHeight: 70,
                    searchBarHeight: 32,
                    deleteTextHeight: 120,
                    deleteConfirmButtonHeight: 40,
                    iconButtonFill: RGBA(
                        0,
                        0,
                        0,
                        0.2
                    ),
                    iconButtonSmallWidth: 30,
                    iconFill: ColorValue("#6264A7"),
                    dividerFill: ColorValue("#EAE9E8"),
                    formLabelFontSize: 10.5,
                    focusBorderColor: ColorValue("#000000"),
                    focusBorderThickness: 2,
                    borderStyle: BorderStyle.Dashed
                }
            }
        );
        //context variable for current screen split between POR form and Purchase items container
        UpdateContext({scrnSplit: varSpltHgh});
        //Set filter for purchase items dropdown, dependant on vendor chosen in POR
        ClearCollect(
            colVendor,
            Filter(
                Vendors,
                Name = DataCardValue9.Selected.Name
            )
        );
        ClearCollect(
            colVOA,
            Filter(
                'Vendor Agreements',
                Vendor in colVendor
            )
        );
        //ClearCollect(colVoaItms, Filter('VOA Items', VOA.'Vendor Agreement' in ShowColumns(colVOA,"cr4e3_vendoragreementid")));
        //filter this vendors VOA Items by VOA/Quotation reference
        ClearCollect(
            colVoaItms,
            Filter(
                'VOA Items',
                VOA.Reference = DataCardValue_VoaRef.Selected.Reference
            )
        );
        UpdateContext({edtFrmVsbl: false});
        
        // varPorId is currently used in POR items filter to total the items qty and price
        If(
            IsBlank(varPorId),
            Set(
                varPorId,
                Gallery_POR.Selected.'Purchase Order Request'
            );
            //Select first record from gallery for Form Item, in case POR data 'view' (filter) is changing
        UpdateContext({selectedRecord: Gallery_POR.Selected});
            //Select row1 in the gallery
        Select(
                Gallery_POR,
                1
            );
            //Select first record from gallery for Form Item, in case POR data 'view' (filter) is changing
        UpdateContext({selectedRecord: Gallery_POR.Selected});
            ,
            false
        );
        //set active tab
        Set(
            varCurrentTab,
            "General"
        );

    LeftContainer1 As groupContainer:
        Height: =Parent.Height
        Visible: =Self.Width <> 0
        Width: =Switch(Parent.Size, ScreenSize.Small, If(Or(newMode, editMode, itemSelected), 0, Parent.Width), 280)
        ZIndex: =2

        Gallery_POR As gallery.BrowseLayout_Vertical_ThreeTextVariant_pcfCore:
            BorderColor: =RGBA(68, 70, 116, 1)
            Default: |-
                =// if app was instantiated with a PORid passed as a parameter, then set gallery item to that POR
                If(IsBlank(varItem), CurrentItem, varItem)
                
                //The below causes the gallery to keep reselecting to first item !
                //If(IsBlank(varItem), First(Gallery_POR.AllItems), varItem)
            DelayItemLoading: =true
            DisplayMode: =If(Or(newMode,editMode,deleteMode), DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            FocusedBorderThickness: =2
            Height: =Parent.Height - 2 * varStyle.topBarHeight
            Items: =If(currentView = 'Purchase Order Requests (Views)'.'POR Templates', Sort(Filter('Purchase Order Requests','Purchase Order Requests (Views)'.'POR Templates'),'Modified On',SortOrder.Descending), Sort(Filter('Purchase Order Requests','Purchase Order Requests (Views)'.'Purchase Orders (non-template)'),'Modified On',SortOrder.Descending))
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: |-
                =UpdateContext({ itemSelected: true, CurrentItem:ThisItem });
                
                // used in filter to total the items qty and price
                Set(varPorId, Gallery_POR.Selected.'Purchase Order Request');
                
                //make sure PRF has latest approval data
                Refresh('Purchase Order Requests');
                
                //Set filter for purchase items dropdown, dependant on vendor chosen in POR
                ClearCollect(colVendor, Filter(Vendors, Name = DataCardValue9.Selected.Name));
                ClearCollect(colVOA, Filter('Vendor Agreements', Vendor in colVendor));
                //ClearCollect(colVoaItms, Filter('VOA Items', VOA.'Vendor Agreement' in ShowColumns(colVOA,"cr4e3_vendoragreementid")));
                
                //filter this vendors VOA Items by VOA/Quotation reference
                ClearCollect(colVoaItms, Filter('VOA Items',  VOA.Reference = DataCardValue_VoaRef.Selected.Reference ));
            TabIndex: =0
            TemplateFill: =If(Self.IsSelected, RGBA(0,0,0,0.05), RGBA(0,0,0,0))
            TemplatePadding: =0
            TemplateSize: =74
            Width: =Parent.Width
            Y: =LeftControlContainer1.Y + LeftControlContainer1.Height
            ZIndex: =1

            Rectangle2 As rectangle:
                BorderColor: =RGBA(224, 224, 237, 1)
                BorderThickness: =1
                DisabledFill: =RGBA(0,0,0,0)
                Fill: =RGBA(0,0,0,0)
                FocusedBorderColor: =RGBA(98, 100, 167, 1)
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(0,0,0,0)
                TabIndex: =0
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Title2 As Label:
                DisplayMode: =DisplayMode.Edit
                FontSize: =8
                FontWeight: =FontWeight.Semibold
                Height: =35
                OnSelect: =Select(Parent)
                PCFTeamsTheme: =TeamsTheme.Default
                TabIndex: =-1
                Text: =ThisItem.'POR Description'
                VerticalAlignment: =VerticalAlign.Top
                Width: =217
                X: =41
                Y: =10
                ZIndex: =2

            Subtitle2 As Label:
                Alignment: =Align.Right
                DisplayMode: =DisplayMode.Edit
                FontSize: =9
                FontWeight: =FontWeight.Normal
                Height: =22
                OnSelect: =Select(Parent)
                PCFTeamsTheme: =TeamsTheme.Default
                TabIndex: =-1
                Text: =Text(ThisItem.'POR Date', "ddd dd mmm yyyy")
                VerticalAlignment: =VerticalAlign.Top
                Width: =107
                X: =151
                Y: =42
                ZIndex: =3

            Body1 As Label:
                DisplayMode: =DisplayMode.Edit
                FontSize: =10
                FontWeight: =FontWeight.Normal
                Height: =22
                OnSelect: =Select(Parent)
                PCFTeamsTheme: =TeamsTheme.Default
                TabIndex: =-1
                Text: =ThisItem.NCSB_Site_ID.Title
                VerticalAlignment: =VerticalAlign.Top
                Width: =121
                X: =41
                Y: =42
                ZIndex: =4

            Circle1 As circle:
                BorderColor: =RGBA(68, 70, 116, 1)
                BorderThickness: =2
                DisabledFill: |-
                    =Switch(
                        ThisItem.'Document Status'.Step,
                        "Initiated (FO)",
                        Color.White,
                        "Procurement Check",
                        Color.DarkGray,
                        "Region Review",
                        Color.Red,
                        "PMO Review",
                        Color.Purple,
                        "Budget Check",
                        Color.Blue,
                        "Management Approval",
                        Color.Magenta,
                        "Group Approval",
                        Color.LightGreen,
                        "Proc. Committee Review",
                        Color.DarkGreen,
                        Color.Red
                    )
                Fill: |-
                    =Switch(
                        ThisItem.'Document Status'.Step,
                        "Initiated (FO)",
                        Color.White,
                        "Procurement Check",
                        Color.DarkGray,
                        "Region Review",
                        Color.Red,
                        "PMO Review",
                        Color.Purple,
                        "Budget Check",
                        Color.Blue,
                        "Management Approval",
                        Color.Magenta,
                        "Group Approval",
                        Color.LightGreen,
                        "Proc. Committee Review",
                        Color.DarkGreen,
                        Color.Red
                    )
                Height: =30
                OnSelect: =Select(Parent)
                PressedFill: |-
                    =Switch(
                        ThisItem.'Document Status'.Step,
                        "Initiated",
                        Color.Yellow,
                        "Region Check",
                        Color.Orange,
                        "PM Check",
                        Color.MediumPurple,
                        "Finance",
                        Color.LightCyan,
                        "Complete",
                        Color.Green
                    )
                Tooltip: =ThisItem.'Document Status'.Step
                Width: =30
                X: =5
                Y: =22
                ZIndex: =5

        TopBar_LeftContainer1 As groupContainer:
            Height: =varStyle.topBarHeight
            Width: =Parent.Width
            ZIndex: =3

            AppNameLabel1 As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(37, 36, 35, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(200, 198, 196, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Parent.Height
                Role: =TextRole.Heading1
                Size: =16
                Text: ="PO Requisitions"
                Width: =Parent.Width - varStyle.topBarTitleLeftPadding - IconBack.Width
                X: =varStyle.topBarTitleLeftPadding + IconBack.Width
                ZIndex: =4

            IconBack As icon.BackArrow:
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =32
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.BackArrow
                OnSelect: =Back()
                PaddingBottom: =3
                PaddingLeft: =3
                PaddingRight: =3
                PaddingTop: =3
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =32
                Y: =10
                ZIndex: =5

        LeftControlContainer1 As groupContainer:
            Height: =varStyle.topBarHeight
            Width: =Parent.Width
            Y: =TopBar_LeftContainer1.Y + TopBar_LeftContainer1.Height
            ZIndex: =5

            IconButton_Add1 As groupContainer:
                Height: =varStyle.searchBarHeight
                Width: =Parent.Width -  varStyle.topBarIconRightPadding
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =6

                IconButton_Add_Icon1 As icon.Add:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: =If(Or(newMode,editMode,deleteMode), DisplayMode.Disabled, DisplayMode.Edit)
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Add
                    PaddingBottom: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =varStyle.largeIconSize - 2 * varStyle.iconPadding
                    X: =12
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =7

                IconButton_Add_Label1 As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =RGBA(37, 36, 35, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisplayMode: =If(Or(newMode,editMode,deleteMode), DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =Parent.Height
                    Size: =10.5
                    Text: ="New PRF"
                    Width: =Parent.Width - IconButton_Add_Icon1.X - IconButton_Add_Icon1.Width
                    X: =IconButton_Add_Icon1.X + IconButton_Add_Icon1.Width
                    ZIndex: =8

                TouchTarget_New1 As rectangle:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    BorderThickness: =2
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: =If(Or(newMode,editMode,deleteMode), DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =Parent.Height
                    HoverFill: =varStyle.iconButtonFill
                    OnSelect: |-
                        =NewForm(EditForm_PORequest); UpdateContext({newMode: true});
                        UpdateContext({edtFrmVsbl: true});
                        NewForm(FormPorDetails)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Create a new PRF"
                    Width: =Parent.Width
                    ZIndex: =9

    LeftRightDivider1 As rectangle:
        BorderColor: =RGBA(243, 242, 241, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =RGBA(200, 198, 196, 1)
        Fill: =varStyle.dividerFill
        FocusedBorderColor: =RGBA(98, 100, 167, 1)
        Height: =Parent.Height
        HoverFill: =RGBA(98, 100, 167, 1)
        PressedFill: =RGBA(98, 100, 167, 1)
        Width: =1
        X: =LeftContainer1.Width
        ZIndex: =11

    RightContainer1 As groupContainer:
        Height: =Parent.Height
        Visible: =Self.Width <> 0
        Width: =Parent.Width - Self.X
        X: =LeftContainer1.Width
        ZIndex: =12

        Container_PorDetails As groupContainer.horizontalAutoLayoutContainer:
            Height: |
                =Parent.Height-EditForm_PORequest.Y-EditForm_PORequest.Height
            LayoutMode: =LayoutMode.Auto
            Visible: =!deleteMode
            Width: =Parent.Width
            Y: =BottomDivider.Y+BottomDivider.Height
            ZIndex: =1

            Container_PorItms_1 As groupContainer.horizontalAutoLayoutContainer:
                Height: =Parent.Height * 0.67
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowX: =LayoutOverflow.Scroll
                LayoutOverflowY: =LayoutOverflow.Scroll
                Width: =Parent.Width
                Y: |-
                    =//btnHeader_4.Y+btnHeader_4.Height
                    Parent.Height * 0.33
                ZIndex: =1

                ContainerPorItms_2 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Height: =70
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =1000
                    LayoutMode: =LayoutMode.Auto
                    Visible: |
                        =true
                    Width: =Parent.Width
                    ZIndex: =2

                    CntnrPorItmHeaders_2 As groupContainer.horizontalAutoLayoutContainer:
                        Fill: =RGBA(224, 224, 237, 1)
                        FillPortions: =0
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =550
                        LayoutMode: =LayoutMode.Auto
                        LayoutOverflowX: =LayoutOverflow.Scroll
                        PaddingLeft: =15
                        Width: =Parent.Width
                        ZIndex: =1

                        LblHdrPorItmPos_2 As Label:
                            AlignInContainer: =AlignInContainer.Center
                            Alignment: =Align.Left
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =60
                            Overflow: ='Label.Overflow'.Hidden
                            Text: ="Pos."
                            Width: =50
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        LblHdrQcMtrlDscprn_2 As Label:
                            Alignment: =Align.Center
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Overflow: ='Label.Overflow'.Hidden
                            Text: ="Description / "
                            VerticalAlignment: =VerticalAlign.Middle
                            Width: =90
                            X: =0
                            Y: =0
                            ZIndex: =2

                        LblHdrVoaPrchsItm_2 As Label:
                            Alignment: =Align.Left
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            FontSize: =10
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =280
                            Overflow: ='Label.Overflow'.Hidden
                            Text: ="Purchase Item"
                            VerticalAlignment: =VerticalAlign.Middle
                            Width: =600
                            X: =0
                            Y: =0
                            ZIndex: =3

                        LblHdrNtPrc_2 As Label:
                            Alignment: =Align.Center
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Semibold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Overflow: ='Label.Overflow'.Hidden
                            Text: ="Unit Price"
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =4

                        LblHdrQty_3 As Label:
                            Alignment: =Align.Center
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =10
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Overflow: ='Label.Overflow'.Hidden
                            Text: ="Qty.  "
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =5

                        LblHdrTtlPrc_3 As Label:
                            Alignment: =Align.Center
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =10
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Overflow: ='Label.Overflow'.Hidden
                            Text: ="Subtotal"
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =6

                    Gallery_PorItems_3 As gallery.BrowseLayout_Vertical_TwoTextVariant_pcfCore:
                        BorderColor: =RGBA(243, 242, 241, 1)
                        DelayItemLoading: =true
                        Fill: =RGBA(244, 244, 243, 1)
                        FocusedBorderColor: =RGBA(98, 100, 167, 1)
                        FocusedBorderThickness: =2
                        Items: |-
                            =Sort(
                                If(
                                    EditForm_PORequest.Mode = FormMode.New,
                                    colPorItems,
                                    Filter(
                                        'Order Request Items',
                                        'POR ID'.'POR Description' = DcvDscrptn.Value
                                    )
                                ),
                                POS ,SortOrder.Ascending
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =550
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplatePadding: =0
                        TemplateSize: =55
                        Width: =Parent.Width
                        ZIndex: =2

                        TotalPrice_2 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Bold
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.Price
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =LblHdrTtlPrc_3.Width
                            X: =LblHdrTtlPrc_3.X
                            Y: =28
                            ZIndex: =2

                        PrchsItmDscptn_2 As Label:
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =10.5
                            FontWeight: =FontWeight.Bold
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.'Purchase Item'.Description
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =LblHdrVoaPrchsItm_2.Width
                            X: =LblHdrVoaPrchsItm_2.X
                            Y: =28
                            ZIndex: =3

                        UntPrice_3 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Lighter
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.'Purchase Item'.'Net Price'
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =LblHdrNtPrc_2.Width
                            X: =LblHdrNtPrc_2.X
                            Y: =28
                            ZIndex: =4

                        Qty_3 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Bold
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.Quantity
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =LblHdrQty_3.Width
                            X: =LblHdrQty_3.X
                            Y: =28
                            ZIndex: =5

                        QcMtrlDscptn_3 As Label:
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Lighter
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.'QC Item ID'.'Material description'
                            VerticalAlignment: =VerticalAlign.Top
                            Width: |
                                =LblHdrQcMtrlDscprn_2.Width + LblHdrVoaPrchsItm_2.Width
                            X: =LblHdrQcMtrlDscprn_2.X
                            Y: =0
                            ZIndex: =6

                        Pos_3 As Label:
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Lighter
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.'QC Item ID'.POS
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =LblHdrPorItmPos_2.Width
                            X: =LblHdrPorItmPos_2.X
                            Y: =0
                            ZIndex: =7

                        Rectangle1_3 As rectangle:
                            BorderColor: =RGBA(243, 242, 241, 1)
                            DisabledFill: =RGBA(0,0,0,0)
                            Fill: =RGBA(0,0,0,0)
                            FocusedBorderColor: =RGBA(98, 100, 167, 1)
                            Height: =55
                            HoverFill: =RGBA(0,0,0,0)
                            OnSelect: =Select(Parent)
                            PressedFill: =RGBA(0,0,0,0)
                            TabIndex: =0
                            Width: =Parent.Width
                            ZIndex: =8

                        Icn_EdtItm_1 As icon.Edit:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Color: =RGBA(98, 100, 167, 1)
                            DisabledBorderColor: =RGBA(243, 242, 241, 1)
                            DisabledColor: =RGBA(220, 220, 220, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Height: =25
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            HoverFill: =RGBA(0, 0, 0, 0)
                            Icon: =Icon.Edit
                            OnSelect: |-
                                =UpdateContext({edtFrmVsbl: true});
                                EditForm(FormPorDetails)
                            PaddingBottom: =3
                            PaddingLeft: =3
                            PaddingRight: =3
                            PaddingTop: =3
                            PressedBorderColor: =RGBA(0, 0, 0, 0)
                            PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            PressedFill: =RGBA(0, 0, 0, 0)
                            Tooltip: ="Edit Item"
                            Width: =25
                            X: =Parent.Width-(Self.Width)-20
                            Y: =10
                            ZIndex: =9

                        Pos_prchsItm As Label:
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Bold
                            Height: =24
                            OnSelect: =Select(Parent)
                            PCFTeamsTheme: =TeamsTheme.Default
                            TabIndex: =-1
                            Text: =ThisItem.POS
                            VerticalAlignment: =VerticalAlign.Top
                            Width: =LblHdrPorItmPos_2.Width
                            X: =LblHdrPorItmPos_2.X
                            Y: =28
                            ZIndex: =10

                    CntnrPorTotals_1 As groupContainer.horizontalAutoLayoutContainer:
                        Fill: =RGBA(230, 230, 230, 1)
                        FillPortions: =0
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =550
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =15
                        Width: =Parent.Width
                        ZIndex: =3

                        LblTtlsSpcr_1 As Label:
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =200
                            Text: ="Totals"
                            Width: =LblHdrPorItmPos_2.Width + LblHdrQcMtrlDscprn_2.Width + LblHdrVoaPrchsItm_2.Width + LblHdrNtPrc_2.Width +LblHdrQty_3.Width
                            X: =0
                            Y: =0
                            ZIndex: =1

                        LblHdrTtlPrc_4 As Label:
                            Alignment: =Align.Left
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =12
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            Overflow: ='Label.Overflow'.Hidden
                            Text: |-
                                =Text(Sum(ShowColumns(Filter('Order Request Items', cr4e3_PORID.'Purchase Order Request' = GUID(varPorId)),"cr4e3_price"), Value(cr4e3_price)),"RM #,##0.00")
                            Width: =LblHdrTtlPrc_3.Width + 100
                            X: =0
                            Y: =0
                            ZIndex: =3

            ContainerPorItmEdt As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(49, 50, 83, 1)
                BorderThickness: =1
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowX: =LayoutOverflow.Scroll
                LayoutOverflowY: =LayoutOverflow.Scroll
                Visible: =edtFrmVsbl And ScrnPrchsOrdrRqst.Size > ScreenSize.Small
                ZIndex: =3

                IconCancel As icon.Cancel:
                    AlignInContainer: =AlignInContainer.End
                    BorderColor: =RGBA(0, 0, 0, 0)
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Height: =32
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Cancel
                    OnSelect: |-
                        =UpdateContext({edtFrmVsbl: false});
                    PaddingBottom: =3
                    PaddingLeft: =3
                    PaddingRight: =3
                    PaddingTop: =3
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =32
                    ZIndex: =1

                FormPorDetails As form:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    DataSource: ='Order Request Items'
                    DefaultMode: =FormMode.New
                    Item: =Gallery_PorItems_3.Selected
                    LayoutMinHeight: =250
                    LayoutMinWidth: =400
                    NumberOfColumns: =1
                    OnSuccess: =ResetForm(FormPorDetails)
                    ZIndex: =2

                    POS_DataCard2 As typedDataCard.pcfCoreTextualEditCard:
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_pos"
                        Default: =ThisItem.POS
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_pos")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        MaxLength: =DataSourceInfo([@'Order Request Items'], DataSourceInfo.MaxLength, "cr4e3_pos")
                        Required: =true
                        Update: =DataCardValue42.Value
                        Width: =543
                        WidthFit: =true
                        X: =0
                        Y: =0
                        ZIndex: =1

                        DataCardKey49 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.DisplayName
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue42 As 'Text box'":
                            AccessibleLabel: =Parent.DisplayName
                            DisplayMode: =Parent.DisplayMode
                            FontSize: =10.5
                            Height: =32
                            Mode: ="SingleLine"
                            PCFTeamsTheme: =TeamsTheme.Default
                            Required: =Parent.Required
                            Tooltip: =Parent.DisplayName
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey49.Y + DataCardKey49.Height + 4
                            ZIndex: =2

                        ErrorMessage43 As Label:
                            AutoHeight: =true
                            Color: =Color.Red
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.Error
                            Tooltip: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue42.Y + DataCardValue42.Height
                            ZIndex: =3

                        StarVisible43 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey49.Y
                            ZIndex: =4

                    "'Purchase Item_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_PurchaseItem"
                        Default: =ThisItem.'Purchase Item'
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_PurchaseItem")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =false
                        Update: =DataCardValue13.Selected
                        Width: =800
                        WidthFit: =true
                        X: =0
                        Y: =1
                        ZIndex: =1

                        DataCardKey16 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Semibold
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.DisplayName
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        DataCardValue13 As combobox:
                            AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                            BorderColor: =RGBA(243, 242, 241, 1)
                            ChevronBackground: =RGBA(243, 242, 241, 1)
                            ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                            ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                            ChevronFill: =RGBA(96, 94, 92, 1)
                            ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                            ChevronHoverFill: =RGBA(96, 94, 92, 1)
                            Color: =RGBA(37, 36, 35, 1)
                            DefaultSelectedItems: =Parent.Default
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(200, 198, 196, 1)
                            DisabledFill: =RGBA(243, 242, 241, 1)
                            DisplayFields: =["cr4e3_description","cr4e3_materialcode"]
                            DisplayMode: =Parent.DisplayMode
                            Fill: =RGBA(243, 242, 241, 1)
                            FocusedBorderColor: =RGBA(98, 100, 167, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            HoverColor: =RGBA(37, 36, 35, 1)
                            HoverFill: =RGBA(243, 242, 241, 1)
                            IsSearchable: =false
                            Items: =Filter('VOA Items', 'Vendor OAI' in ShowColumns(colVoaItms,"cr4e3_vendoroaid"))
                            PaddingLeft: =12
                            PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            PressedColor: =RGBA(255, 255, 255, 1)
                            PressedFill: =RGBA(243, 242, 241, 1)
                            SearchFields: =["cr4e3_description"]
                            SearchItems: =[]
                            SelectionColor: =RGBA(37, 36, 35, 1)
                            SelectionFill: =RGBA(237, 235, 233, 1)
                            SelectMultiple: =false
                            Size: =10.5
                            Template: =ListItemTemplate.Double
                            Tooltip: =Parent.DisplayName
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey16.Y + DataCardKey16.Height + 4
                            ZIndex: =2

                        ErrorMessage15 As Label:
                            AutoHeight: =true
                            Color: =Color.Red
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.Error
                            Tooltip: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue13.Y + DataCardValue13.Height
                            ZIndex: =3

                        StarVisible15 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            Height: =20
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="*"
                            VerticalAlignment: =VerticalAlign.Bottom
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey16.Y
                            ZIndex: =4

                    "'QC Item ID_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_QCItemID"
                        Default: =ThisItem.'QC Item ID'
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_QCItemID")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =false
                        Update: =DataCardValue16.Selected
                        Width: =800
                        WidthFit: =true
                        X: =0
                        Y: =3
                        ZIndex: =1

                        DataCardKey19 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="QC Item"
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        DataCardValue16 As combobox:
                            AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                            BorderColor: =RGBA(243, 242, 241, 1)
                            ChevronBackground: =RGBA(243, 242, 241, 1)
                            ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                            ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                            ChevronFill: =RGBA(96, 94, 92, 1)
                            ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                            ChevronHoverFill: =RGBA(96, 94, 92, 1)
                            Color: =RGBA(37, 36, 35, 1)
                            DefaultSelectedItems: =Parent.Default
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(200, 198, 196, 1)
                            DisabledFill: =RGBA(243, 242, 241, 1)
                            DisplayFields: =["cr4e3_materialdescription","cr4e3_materialcode"]
                            DisplayMode: =Parent.DisplayMode
                            Fill: =RGBA(243, 242, 241, 1)
                            FocusedBorderColor: =RGBA(98, 100, 167, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            HoverColor: =RGBA(37, 36, 35, 1)
                            HoverFill: =RGBA(243, 242, 241, 1)
                            IsSearchable: =false
                            Items: |-
                                =Sort(
                                    Choices([@'Order Request Items'].'QC Item ID'),
                                    POS
                                )
                            PaddingLeft: =12
                            PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            PressedColor: =RGBA(255, 255, 255, 1)
                            PressedFill: =RGBA(243, 242, 241, 1)
                            SearchFields: =["cr4e3_materialdescription"]
                            SearchItems: =[]
                            SelectionColor: =RGBA(37, 36, 35, 1)
                            SelectionFill: =RGBA(237, 235, 233, 1)
                            SelectMultiple: =false
                            Size: =10.5
                            Template: =ListItemTemplate.Double
                            Tooltip: =Parent.DisplayName
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey19.Y + DataCardKey19.Height + 4
                            ZIndex: =2

                        ErrorMessage17 As Label:
                            AutoHeight: =true
                            Color: =Color.Red
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.Error
                            Tooltip: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue16.Y + DataCardValue16.Height
                            ZIndex: =3

                        StarVisible17 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            Height: =20
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="*"
                            VerticalAlignment: =VerticalAlign.Bottom
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey19.Y
                            ZIndex: =4

                    "'Order Request Item_DataCard1' As typedDataCard.pcfCoreTextualViewCard":
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_orderrequestitemid"
                        Default: =ThisItem.'Order Request Item'
                        DisplayMode: =DisplayMode.View
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_orderrequestitemid")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =false
                        Width: =800
                        WidthFit: =true
                        X: =0
                        Y: =4
                        ZIndex: =1

                        DataCardKey18 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.DisplayName
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue15 As 'Text box'":
                            DisplayMode: =DisplayMode.View
                            FontSize: =10.5
                            Height: =32
                            Mode: ="SingleLine"
                            PCFTeamsTheme: =TeamsTheme.Default
                            Tooltip: =Parent.DisplayName
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey18.Y + DataCardKey18.Height + 4
                            ZIndex: =2

                    "'POR ID_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_PORID"
                        Default: =Gallery_POR.Selected
                        DisplayMode: =DisplayMode.Disabled
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_PORID")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =false
                        Update: =DataCardValue14.Selected
                        Width: =800
                        WidthFit: =true
                        X: =0
                        Y: =6
                        ZIndex: =1

                        DataCardKey17 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.DisplayName
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        DataCardValue14 As combobox:
                            AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                            BorderColor: =RGBA(243, 242, 241, 1)
                            ChevronBackground: =RGBA(243, 242, 241, 1)
                            ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                            ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                            ChevronFill: =RGBA(96, 94, 92, 1)
                            ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                            ChevronHoverFill: =RGBA(96, 94, 92, 1)
                            Color: =RGBA(37, 36, 35, 1)
                            DefaultSelectedItems: =Parent.Default
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(200, 198, 196, 1)
                            DisabledFill: =RGBA(243, 242, 241, 1)
                            DisplayFields: =["cr4e3_name"]
                            DisplayMode: =Parent.DisplayMode
                            Fill: =RGBA(243, 242, 241, 1)
                            FocusedBorderColor: =RGBA(98, 100, 167, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            HoverColor: =RGBA(37, 36, 35, 1)
                            HoverFill: =RGBA(243, 242, 241, 1)
                            Items: =Choices([@'Order Request Items'].'POR ID')
                            PaddingLeft: =12
                            PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                            PressedColor: =RGBA(255, 255, 255, 1)
                            PressedFill: =RGBA(243, 242, 241, 1)
                            SearchFields: =["cr4e3_name"]
                            SearchItems: =Search(Choices([@'Order Request Items'].'POR ID'),DataCardValue14.SearchText,"cr4e3_name")
                            SelectionColor: =RGBA(37, 36, 35, 1)
                            SelectionFill: =RGBA(237, 235, 233, 1)
                            SelectMultiple: =false
                            Size: =10.5
                            Tooltip: =Parent.DisplayName
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey17.Y + DataCardKey17.Height + 4
                            ZIndex: =2

                        ErrorMessage16 As Label:
                            AutoHeight: =true
                            Color: =Color.Red
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.Error
                            Tooltip: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue14.Y + DataCardValue14.Height
                            ZIndex: =3

                        StarVisible16 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            Height: =20
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="*"
                            VerticalAlignment: =VerticalAlign.Bottom
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey17.Y
                            ZIndex: =4

                    Quantity_DataCard1 As typedDataCard.pcfCoreNumberEditCard:
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_quantity"
                        Default: =ThisItem.Quantity
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_quantity")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =true
                        Update: =Value(DataCardValue12.Text)
                        Width: =800
                        WidthFit: =true
                        X: =0
                        Y: =2
                        ZIndex: =2

                        DataCardKey15 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            FontWeight: =FontWeight.Semibold
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.DisplayName
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        DataCardValue12 As text:
                            AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                            BorderColor: =RGBA(243, 242, 241, 1)
                            BorderThickness: =0
                            Color: =RGBA(37, 36, 35, 1)
                            Default: =Parent.Default
                            DelayOutput: =true
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(200, 198, 196, 1)
                            DisabledFill: =RGBA(243, 242, 241, 1)
                            DisplayMode: =Parent.DisplayMode
                            Fill: =RGBA(243, 242, 241, 1)
                            FocusedBorderColor: =RGBA(98, 100, 167, 1)
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Bold
                            Format: =TextFormat.Number
                            Height: =32
                            HoverBorderColor: =RGBA(243, 242, 241, 1)
                            HoverColor: =RGBA(37, 36, 35, 1)
                            HoverFill: =RGBA(243, 242, 241, 1)
                            PaddingBottom: =4
                            PaddingRight: =12
                            PaddingTop: =0
                            PressedBorderColor: =RGBA(98, 100, 167, 1)
                            PressedColor: =RGBA(37, 36, 35, 1)
                            PressedFill: =RGBA(243, 242, 241, 1)
                            RadiusBottomLeft: =3
                            RadiusBottomRight: =3
                            RadiusTopLeft: =3
                            RadiusTopRight: =3
                            Size: =10.5
                            Tooltip: =Parent.DisplayName
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey15.Y + DataCardKey15.Height + 4
                            ZIndex: =2

                        ErrorMessage14 As Label:
                            AutoHeight: =true
                            Color: =Color.Red
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.Error
                            Tooltip: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue12.Y + DataCardValue12.Height
                            ZIndex: =3

                        StarVisible14 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey15.Y
                            ZIndex: =4

                    "'Item ID_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="cr4e3_itemid"
                        Default: =ThisItem.PorItem_ID
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'Order Request Items'],DataSourceInfo.DisplayName,"cr4e3_itemid")
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        MaxLength: =DataSourceInfo([@'Order Request Items'], DataSourceInfo.MaxLength, "cr4e3_itemid")
                        Required: =false
                        Update: =DataCardValue11.Value
                        Width: =800
                        WidthFit: =true
                        X: =0
                        Y: =5
                        ZIndex: =2

                        DataCardKey14 As Label:
                            AutoHeight: =true
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =22
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.DisplayName
                            Tooltip: =Parent.DisplayName
                            VerticalAlignment: =VerticalAlign.Bottom
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue11 As 'Text box'":
                            AccessibleLabel: =Parent.DisplayName
                            DisplayMode: =Parent.DisplayMode
                            FontSize: =10.5
                            Height: =32
                            Mode: ="SingleLine"
                            PCFTeamsTheme: =TeamsTheme.Default
                            Required: =Parent.Required
                            Tooltip: =Parent.DisplayName
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey14.Y + DataCardKey14.Height + 4
                            ZIndex: =2

                        ErrorMessage13 As Label:
                            AutoHeight: =true
                            Color: =Color.Red
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =9
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: =Parent.Error
                            Tooltip: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue11.Y + DataCardValue11.Height
                            ZIndex: =3

                        StarVisible13 As Label:
                            Alignment: =Align.Center
                            DisplayMode: =DisplayMode.Edit
                            Height: =30
                            PCFTeamsTheme: =TeamsTheme.Default
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey14.Y
                            ZIndex: =4

                Container5 As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0.1
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =35
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =35
                    LayoutMinWidth: =124
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =6

                    ButtonNew_1 As Button:
                        BorderColor: =RGBA(224, 224, 237, 1)
                        BorderRadius: =0
                        ButtonType: ='Button.ButtonType'.Primary
                        DisabledBorderColor: =RGBA(224, 224, 237, 1)
                        DisplayMode: =DisplayMode.Edit
                        FillColor: =RGBA(161, 162, 202, 1)
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =RGBA(224, 224, 237, 1)
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |
                            =ResetForm(FormPorDetails)
                        PCFTeamsTheme: =TeamsTheme.Default
                        PressedBorderColor: =RGBA(224, 224, 237, 1)
                        Text: ="New"
                        TextColor: =RGBA(0, 0, 0, 1)
                        Width: =150
                        X: =0
                        Y: =0
                        ZIndex: =1

                    ButtonSave As Button:
                        BorderColor: =RGBA(224, 224, 237, 1)
                        BorderRadius: =0
                        ButtonType: ='Button.ButtonType'.Primary
                        DisabledBorderColor: =RGBA(224, 224, 237, 1)
                        DisplayMode: =DisplayMode.Edit
                        FillColor: =RGBA(161, 162, 202, 1)
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =RGBA(224, 224, 237, 1)
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |-
                            =//If the new POR is not yet saved, then hold the data in a collection
                            If (
                                EditForm_PORequest.Mode = FormMode.New,
                                Collect(
                                    colPorItems,
                                    FormPorDetails.Updates
                                );
                                ResetForm(FormPorDetails),
                                SubmitForm(FormPorDetails)
                            )
                        PCFTeamsTheme: =TeamsTheme.Default
                        PressedBorderColor: =RGBA(224, 224, 237, 1)
                        Text: ="Save"
                        TextColor: =RGBA(0, 0, 0, 1)
                        Width: =150
                        X: =0
                        Y: =0
                        ZIndex: =2

                    ButtonDelete_1 As Button:
                        BorderColor: =RGBA(224, 224, 237, 1)
                        BorderRadius: =0
                        ButtonType: ='Button.ButtonType'.Primary
                        DisabledBorderColor: =RGBA(224, 224, 237, 1)
                        DisplayMode: =DisplayMode.Edit
                        FillColor: =RGBA(161, 162, 202, 1)
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =RGBA(224, 224, 237, 1)
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |-
                            =Remove('Order Request Items', Gallery_PorItems_3.Selected);
                            ResetForm(FormPorDetails);
                            NewForm(FormPorDetails);
                        PCFTeamsTheme: =TeamsTheme.Default
                        PressedBorderColor: =RGBA(224, 224, 237, 1)
                        Text: ="Delete"
                        TextColor: =RGBA(0, 0, 0, 1)
                        Width: =150
                        X: =0
                        Y: =0
                        ZIndex: =3

        BottomDivider As rectangle:
            BorderColor: =RGBA(243, 242, 241, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(200, 198, 196, 1)
            Fill: =varStyle.dividerFill
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            Height: =1
            HoverFill: =RGBA(98, 100, 167, 1)
            PressedFill: =RGBA(98, 100, 167, 1)
            Width: =Parent.Width
            Y: =EditForm_PORequest.Y + EditForm_PORequest.Height
            ZIndex: =2

        EditForm_PORequest As form:
            BorderColor: =RGBA(98, 100, 167, 1)
            DataSource: ='Purchase Order Requests'
            DefaultMode: =If(newMode, FormMode.New, If(editMode, FormMode.Edit, FormMode.View))
            Height: =(Parent.Height-varStyle.topBarHeight-TopBottomDivider1.Height) * scrnSplit
            Item: |-
                =//If(Gallery_POR.DisplayMode = DisplayMode.Disabled, selectedRecord, Gallery_POR.Selected)
                If(IsBlank(Gallery_POR.Selected), selectedRecord, Gallery_POR.Selected)
            NumberOfColumns: =6
            OnFailure: =Notify("Cannot save. Please check if there are errors in the form.",NotificationType.Error)
            OnSuccess: |-
                =If(
                    newMode,
                    Patch(
                        'Order Request Items',
                        UpdateIf(
                            colPorItems,
                            true,
                            {'POR ID': Self.LastSubmit}
                        )
                    );
                    Clear(colPorItems)
                );
                UpdateContext(
                    {
                        CurrentItem: Self.LastSubmit,
                        editMode: false,
                        newMode: false
                    }
                )
            Visible: =!deleteMode
            Width: =Parent.Width
            Y: =ContainerTabBtns.Y + ContainerTabBtns.Height
            ZIndex: =3

            "'POR Description_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                BorderColor: =RGBA(244, 244, 243, 1)
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                DataField: ="cr4e3_name"
                Default: =ThisItem.'POR Description'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_name")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                MaxLength: =DataSourceInfo([@'Purchase Order Requests'], DataSourceInfo.MaxLength, "cr4e3_name")
                Required: =true
                Update: =DcvDscrptn.Value
                Visible: =varCurrentTab = "General"
                Width: =543
                WidthFit: =false
                X: =0
                Y: =0
                ZIndex: =1

                DataCardKey4 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    FontWeight: =FontWeight.Semibold
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Description"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =314
                    Wrap: =true
                    X: =24
                    Y: =14
                    ZIndex: =1

                "DcvDscrptn As 'Text box'":
                    AccessibleLabel: =Parent.DisplayName
                    DisplayMode: =Parent.DisplayMode
                    FontSize: =10.5
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    Mode: ="SingleLine"
                    PCFTeamsTheme: =TeamsTheme.Default
                    Required: =Parent.Required
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =495
                    X: =24
                    Y: =44
                    ZIndex: =2

                ErrorMessage3 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DcvDscrptn.Y + DcvDscrptn.Height
                    ZIndex: =3

                StarVisible3 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey4.Y
                    ZIndex: =4

            Template_DataCard1 As typedDataCard.pcfCoreComboBoxOptionSetSingleEditCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_template"
                Default: =If(IsBlank(ThisItem.Template), 'Template (Purchase Order Requests)'.No, ThisItem.Template)
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_template")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =true
                Update: =DataCardValue1.Selected.Value
                Visible: =varCurrentTab = "General"
                Width: =181
                WidthFit: =false
                X: =3
                Y: =0
                ZIndex: =1

                DataCardKey1 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =18
                    ZIndex: =1

                DataCardValue1 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =
                    ChevronBackground: =If(ThisItem.Template, RGBA(152, 208, 70, 1), RGBA(243, 242, 241, 1))
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =
                    DefaultSelectedItems: |
                        =[Parent.Default]
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =If(ThisItem.Template, RGBA(152, 208, 70, 1), RGBA(243, 242, 241, 1))
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    IsSearchable: =false
                    Items: =Choices('Template (Purchase Order Requests)')
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(0, 0, 0, 1)
                    SelectionFill: =If(ThisItem.Template, RGBA(152, 208, 70, 1), RGBA(243, 242, 241, 1))
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: ="Is this PRF a template (or an actual PRF) ?"
                    Width: =75
                    X: =24
                    Y: =DataCardKey1.Y + DataCardKey1.Height + 4
                    ZIndex: =2

                ErrorMessage39 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue1.Y + DataCardValue1.Height
                    ZIndex: =3

                StarVisible39 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey1.Y
                    ZIndex: =4

            "'WBS Template_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_WBSTemplate"
                Default: =ThisItem.'WBS Template'
                DisplayMode: =DisplayMode.View
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_WBSTemplate")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =DataCardValue4.Selected
                Visible: =varCurrentTab = "General"
                Width: =362
                WidthFit: =false
                X: =4
                Y: =0
                ZIndex: =1

                DataCardKey5 As Label:
                    AutoHeight: =true
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Template Name"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =22
                    ZIndex: =1

                DataCardValue4 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_modelsite","cr4e3_elementno"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    Items: =Choices([@'Purchase Order Requests'].'WBS Template')
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_modelsite"]
                    SearchItems: =Search(Choices([@'Purchase Order Requests'].'WBS Template'),DataCardValue4.SearchText,"cr4e3_modelsite")
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Template: =ListItemTemplate.Double
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =44
                    ZIndex: =2

                ErrorMessage4 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue4.Y + DataCardValue4.Height
                    ZIndex: =3

                StarVisible4 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey5.Y
                    ZIndex: =4

            DataCardSlctTmplt As typedDataCard.blankCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DisplayMode: =DisplayMode.Edit
                Fill: =RGBA(0, 0, 0, 0)
                Height: =60
                Visible: |
                    =Not(ThisItem.Template) And EditForm_PORequest.Mode=FormMode.New And varCurrentTab = "General"
                Width: =850
                WidthFit: =true
                X: =0
                Y: =1
                ZIndex: =1

                Container1 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =Parent.Height
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =50
                    PaddingRight: =50
                    Width: =Parent.Width
                    ZIndex: =1

                    LblSlctTmplt As Label:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(255, 0, 0, 1)
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        Text: ="Select POR template"
                        Width: =150
                        X: =0
                        Y: =0
                        ZIndex: =1

                    "CmbBxSlctTmplt As 'Combo box'.pcfdataset":
                        AlignInContainer: =AlignInContainer.Center
                        AllowSearching: =true
                        DisplayMode: =DisplayMode.Edit
                        Height: =35
                        Items: =Filter('WBS Elements', Template)
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        PCFTeamsTheme: =TeamsTheme.Default
                        Tooltip: ="Select a template to base the purchase order request on"
                        Width: =Parent.Width - LblSlctTmplt.Width - 200
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "'Model Site1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Model Site"
                            FieldName: ="cr4e3_modelsite"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =40

                        "'Element No1' As pcfDataField.textualColumn":
                            FieldDisplayName: ="Element No"
                            FieldName: ="cr4e3_elementno"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =9
                            ZIndex: =41

                    BtnCrtFrmTmplt As Button:
                        AlignInContainer: =AlignInContainer.Center
                        Alignment: =Align.Center
                        BorderColor: =RGBA(49, 50, 83, 1)
                        BorderRadius: =5
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =2
                        ButtonType: ='Button.ButtonType'.Primary
                        DisplayMode: =If(IsBlank(CmbBxSlctTmplt.Selected) Or IsBlank(DcvDscrptn.Value) Or IsBlank(CmbBxApprvlWrkflw.Selected), DisplayMode.Disabled, DisplayMode.Edit)
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |-
                            =Notify(
                                "PRF creation underway...please wait",
                                NotificationType.Information
                            );
                            If(
                                PopulatePRFfromTemplate.Run(
                                    CmbBxSlctTmplt.Selected.'Model Site',
                                    DcvDscrptn.Value,
                                    CmbBxApprvlWrkflw.Selected.Workflow
                                ).result = "success",
                                Notify(
                                    "PRF was successfully created",
                                    NotificationType.Success
                                );
                                UpdateContext(
                                    {
                                        CurrentItem: LookUp(
                                            'Purchase Order Requests',
                                            'POR Description' = DcvDscrptn.Value
                                        ),
                                        editMode: false,
                                        newMode: false
                                    }
                                );
                                Refresh('Purchase Order Requests'),
                                Notify(
                                    "Something went wrong with creating the PRF. Do contact your admin.",
                                    NotificationType.Error
                                )
                            )
                        Text: ="Create PRF"
                        Width: =96
                        X: =0
                        Y: =0
                        ZIndex: =3

            "'Created By_DataCard1' As typedDataCard.pcfCoreComboBoxViewCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="createdby"
                Default: =ThisItem.'Created By'
                DisplayMode: =DisplayMode.View
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"createdby")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Visible: =varCurrentTab = "General" And Not(EditForm_PORequest.Mode = FormMode.New)
                Width: =362
                WidthFit: =false
                X: =0
                Y: =2
                ZIndex: =1

                DataCardKey32 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Requestor"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =22
                    ZIndex: =1

                DataCardValue3 As combobox:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["fullname"]
                    DisplayMode: =DisplayMode.View
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    Items: =Choices([@'Purchase Order Requests'].'Created By')
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["fullname"]
                    SearchItems: =Search(Choices([@'Purchase Order Requests'].'Created By'),DataCardValue3.SearchText,"fullname")
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =DataCardKey32.Y + DataCardKey32.Height + 4
                    ZIndex: =2

            NCSB_Site_ID_DataCard1 As typedDataCard.pcfCoreComboBoxEditCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_NCSB_Site_ID"
                Default: =ThisItem.NCSB_Site_ID
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_NCSB_Site_ID")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =DataCardValue2.Selected
                Visible: =varCurrentTab = "General"
                Width: =543
                WidthFit: =false
                X: =2
                Y: =2
                ZIndex: =1

                DataCardKey3 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =38
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="NCSB Site ID"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =151
                    Wrap: =true
                    X: =24
                    Y: =10
                    ZIndex: =1

                DataCardValue2 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_title","cr4e3_site_name"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    Items: =Choices([@'Purchase Order Requests'].NCSB_Site_ID)
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_site_name"]
                    SearchItems: =Search(Choices([@'Purchase Order Requests'].NCSB_Site_ID),DataCardValue2.SearchText,"cr4e3_site_name")
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Template: =ListItemTemplate.Double
                    Tooltip: ="Naza site ID (if applicable)"
                    Width: =134
                    X: =24
                    Y: =48
                    ZIndex: =2

                ErrorMessage2 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue2.Y + DataCardValue2.Height
                    ZIndex: =3

                StarVisible2 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey3.Y
                    ZIndex: =4

                DataCardValue2_1 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_site_name","cr4e3_title"]
                    DisplayMode: =DisplayMode.View
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    Items: =Choices([@'Purchase Order Requests'].NCSB_Site_ID)
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_site_name"]
                    SearchItems: =Search(Choices([@'Purchase Order Requests'].NCSB_Site_ID),DataCardValue2_1.SearchText,"cr4e3_site_name")
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: ="Naza site ID (if applicable)"
                    Width: =252
                    X: =178
                    Y: =48
                    ZIndex: =5

                DataCardKey3_1 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =38
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Name"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =151
                    Wrap: =true
                    X: =178
                    Y: =10
                    ZIndex: =6

            "'Approval Workflow_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_ApprovalWorkflow"
                Default: =ThisItem.'Approval Workflow'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_ApprovalWorkflow")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =CmbBxApprvlWrkflw.Selected
                Visible: =varCurrentTab = "Approvals"
                Width: =362
                WidthFit: =false
                X: =0
                Y: =3
                ZIndex: =1

                DataCardKey33 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    FontWeight: =FontWeight.Semibold
                    Height: =24
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =340
                    Wrap: =true
                    X: =24
                    Y: =16
                    ZIndex: =1

                CmbBxApprvlWrkflw As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_name"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    IsSearchable: =false
                    Items: =Choices([@'Purchase Order Requests'].'Approval Workflow')
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_name"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: ="Approval workflow name"
                    Width: =340
                    X: =24
                    Y: =DataCardKey33.Y + DataCardKey33.Height + 4
                    ZIndex: =2

                ErrorMessage27 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =CmbBxApprvlWrkflw.Y + CmbBxApprvlWrkflw.Height
                    ZIndex: =3

                StarVisible27 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey33.Y
                    ZIndex: =4

            DataCardInitApprvlBtn As typedDataCard.blankCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DisplayMode: =Parent.DisplayMode
                Fill: =RGBA(0, 0, 0, 0)
                Height: =76
                Visible: =varCurrentTab = "Approvals"
                Width: =362
                X: =2
                Y: =3
                ZIndex: =1

                Button2 As Button:
                    BorderColor: =RGBA(98, 100, 167, 1)
                    BorderRadius: =10
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =1
                    ButtonType: ='Button.ButtonType'.Standard
                    DisplayMode: =Parent.DisplayMode
                    Height: =32
                    OnSelect: |
                        =//Save PRF and initiate approval
                        // 26/04/23: all 'Thisitem' changed to 'CurrentItem'
                        // 29/05/23: Patching of 'doc status' added in case approval flow is being re-initiated, i.e. status was already at an 'approval order' > 1 
                        
                        
                        //*** TODO: ***   Add a confirmation dialogue here to make sure the user really wants to init a new approval flow
                        
                        
                        SubmitForm(EditForm_PORequest);
                        UpdateContext({editMode: false, newMode: false}); //edit:line added 11/04
                        UpdateContext({edtFrmVsbl: false});
                        Set(CurrentItem, EditForm_PORequest.LastSubmit);
                        
                        //edit: next 2 lines added 26/04
                        //IfError(Patch(CurrentItem, {'Document Status': LookUp('Workflow Steps', Workflow.Name = CmbBxApprvlWrkflw.Selected.Name And 'Approval Order' = 1)}),  Notify( $"OOPS: { FirstError.Message }", NotificationType.Warning));
                        
                        Refresh('Purchase Order Requests');
                        
                        Notify(
                            "Form saved and approval triggered",
                            NotificationType.Information,
                            3000
                        );
                        
                        // Filter the 'workflow steps' that belong to the selected 'workflow Name' and have an approver assigned
                        // NOTE: First step should be for initiation step, e.g. named 'Initiated' or 'PRF created' and have no approver assigned
                        // sort by 'Approval Order' value
                        // include 'Workflow Approval Group' (Choice Name) for future checks !!! TO DO !!!
                        ClearCollect(
                            colSteps,
                            Sort(
                                Filter(
                                    'Workflow Steps',
                                    Workflow.Workflow = CurrentItem.'Approval Workflow'.Workflow And Not(IsBlank(Approver))
                                ),
                                'Approval Order',
                                SortOrder.Ascending
                            )
                        );
                        
                        
                        //create a collection of the GUID's for the approvers involved in the steps above
                        //Include GUID's for the workflow and users
                        ClearCollect(
                            colUsers,
                            AddColumns(
                                ShowColumns(
                                    colSteps,
                                    "cr4e3_Workflow",
                                    "cr4e3_Approver",
                                    "cr4e3_step",
                                    "cr4e3_workflowapprovalgroup"
                                ),
                                "myGuid",
                                cr4e3_Approver.User,
                                "workflowGuid",
                                cr4e3_Workflow.Workflow
                            )
                        );
                        
                        
                        //for each user get the full name and email address, and approval group (for future cross-check with step workflowapprovalgroup)
                        ClearCollect(
                            colApprovers,
                            AddColumns(
                                colUsers,
                                "fullname",
                                LookUp(
                                    Users,
                                    User = myGuid//GUID column in collection from previous step
                                ).'Full Name',
                                "internalemailaddress",
                                LookUp(
                                    Users,
                                    User = myGuid//GUID column in collection from previous step
                                ).'Primary Email',
                                "cr960_userapprovalgroup", // changed from cr4e3_userapprovalgroup for User table in development environment
                                LookUp(
                                    Users,
                                    User = myGuid//GUID column in collection from previous step
                                ).'User Approval Group (cr960_userapprovalgroup)'
                            )
                        );
                        //Trigger the power-flow to run the approvals for this collection of approvers
                        //NOTE !!! 
                        Set(
                            varResult,
                            triggerapprovalV9.Run(
                                CurrentItem.'Purchase Order Request',
                                JSON(
                                    colApprovers,
                                    JSONFormat.IndentFour
                                ),
                                CurrentItem.'POR Description'
                            )
                        );
                        
                        //Inform end-user that approval flow has started
                        If(varResult.result = "failed", Notify(
                            "Approval flow failed...please contact your app administrator",
                            NotificationType.Error,
                            3000), Notify(
                            "Approval flow was initiated successfully",
                            NotificationType.Success,
                            3000) 
                        );
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Init. Approval"
                    Tooltip: ="Submit changes and trigger approval"
                    Width: =96
                    X: =40
                    Y: =46
                    ZIndex: =1

            "'Document Status_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_DocumentStatus"
                Default: =ThisItem.'Document Status'
                DisplayMode: =DisplayMode.View
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_DocumentStatus")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =DataCardValue10.Selected
                Visible: =varCurrentTab = "Approvals"
                Width: =362
                WidthFit: =false
                X: =4
                Y: =3
                ZIndex: =1

                DataCardKey13 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =28
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Last Approval"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =240
                    Wrap: =true
                    X: =24
                    Y: =14
                    ZIndex: =1

                DataCardValue10 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: |
                        =//if it's a new POR then set to the first step of selected approval workflow, otherwise leave as is
                        //If(EditForm_PORequest.Mode = FormMode.New, LookUp('Workflow Steps', Workflow.Name = CmbBxApprvlWrkflw.Selected.Name And 'Approval Order' = 1), ThisItem.'Document Status')
                        
                        If(EditForm_PORequest.Mode = FormMode.New Or IsBlank(ThisItem.'Document Status'), LookUp('Workflow Steps', Workflow.Name = CmbBxApprvlWrkflw.Selected.Name And 'Approval Order' = 1), ThisItem.'Document Status')
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_step"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    InputTextPlaceholder: ="Approvals pending..."
                    IsSearchable: =false
                    Items: |-
                        =//changed 17/04
                        //Filter('Workflow Steps', Workflow.Name = ThisItem.'Approval Workflow'.Name)
                        
                        Filter('Workflow Steps', Workflow.Name = CmbBxApprvlWrkflw.Selected.Name)
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_step"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: ="Last completed approval status"
                    Width: =240
                    X: =24
                    Y: =42
                    ZIndex: =2

                ErrorMessage12 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue10.Y + DataCardValue10.Height
                    ZIndex: =3

                StarVisible12 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey13.Y
                    ZIndex: =4

            Vendor_DataCard1 As typedDataCard.pcfCoreComboBoxEditCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_Vendor"
                Default: =ThisItem.Vendor
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_Vendor")
                Fill: =RGBA(255, 255, 255, 1)
                Height: =70
                Required: =true
                Update: =DataCardValue9.Selected
                Visible: =varCurrentTab = "Voa"
                Width: =362
                WidthFit: =false
                X: =0
                Y: =4
                ZIndex: =1

                DataCardKey12 As Label:
                    AutoHeight: =true
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =18
                    ZIndex: =1

                DataCardValue9 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_name"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    Items: =Choices([@'Purchase Order Requests'].Vendor)
                    OnChange: |-
                        =//Set filter for purchase items dropdown, dependant on vendor chosen in POR
                        ClearCollect(colVendor, Filter(Vendors, Name = DataCardValue9.Selected.Name));
                        ClearCollect(colVOA, Filter('Vendor Agreements', Vendor in colVendor));
                        //ClearCollect(colVoaItms, Filter('VOA Items', VOA.'Vendor Agreement' in ShowColumns(colVOA,"cr4e3_vendoragreementid")))
                        
                        //filter this vendors VOA Items by VOA/Quotation reference
                        ClearCollect(colVoaItms, Filter('VOA Items',  VOA.Reference = DataCardValue_VoaRef.Selected.Reference ));
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_name"]
                    SearchItems: =Search(Choices([@'Purchase Order Requests'].Vendor),DataCardValue9.SearchText,"cr4e3_name")
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =287
                    X: =24
                    Y: =44
                    ZIndex: =2

                ErrorMessage11 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue9.Y + DataCardValue9.Height
                    ZIndex: =3

                StarVisible11 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey12.Y
                    ZIndex: =4

            "'VOA / Quotation_DataCard1' As typedDataCard.pcfCoreComboBoxEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                DataField: ="cr4e3_VOAQuotation"
                Default: =ThisItem.'VOA / Quotation'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_VOAQuotation")
                Fill: =RGBA(255, 255, 255, 1)
                Height: =70
                Required: =false
                Update: =DataCardValue_VoaRef.Selected
                Visible: =varCurrentTab = "Voa"
                Width: =362
                WidthFit: =false
                X: =2
                Y: =4
                ZIndex: =1

                DataCardKey48 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =22
                    ZIndex: =1

                DataCardValue_VoaRef As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_name"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    IsSearchable: =false
                    Items: |-
                        =//Choices([@'Purchase Order Requests'].cr4e3_VOAQuotation)
                        Filter('Vendor Agreements', Vendor.Name = DataCardValue9.Selected.Name)
                    OnChange: |-
                        =//Set filter for purchase items dropdown, dependant on vendor chosen in POR
                        ClearCollect(colVendor, Filter(Vendors, Name = DataCardValue9.Selected.Name));
                        ClearCollect(colVOA, Filter('Vendor Agreements', Vendor in colVendor));
                        //filter this vendors VOA Items by VOA/Quotation reference
                        ClearCollect(colVoaItms, Filter('VOA Items',  VOA.Reference = DataCardValue_VoaRef.Selected.Reference ));
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_name"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =44
                    ZIndex: =2

                ErrorMessage42 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue_VoaRef.Y + DataCardValue_VoaRef.Height
                    ZIndex: =3

                StarVisible42 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey48.Y
                    ZIndex: =4

            Attachment_DataCard1 As typedDataCard.pcfCoreComboBoxEditCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_Attachment"
                Default: =ThisItem.Attachment
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_Attachment")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =285
                Required: =false
                Update: =DataCardValue41.Selected
                Visible: =varCurrentTab = "Voa"
                Width: =905
                WidthFit: =false
                X: =0
                Y: =6
                ZIndex: =1

                DataCardValue41 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["cr4e3_name"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    IsSearchable: =false
                    Items: =Choices([@'Purchase Order Requests'].cr4e3_Attachment)
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["cr4e3_name"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    SelectMultiple: =false
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Visible: =false
                    Width: =215
                    X: =336
                    Y: =91
                    ZIndex: =1

                ErrorMessage45 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =214
                    Wrap: =true
                    X: =337
                    Y: =119
                    ZIndex: =2

                StarVisible45 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =313
                    Y: =61
                    ZIndex: =3

                HtmlText_LinkToItem As htmlViewer:
                    Height: =73
                    HtmlText: ="<a href='" & LookUp('File Attachments', Attachment = ThisItem.Attachment.Attachment).Link_to_Item & "'> " & LookUp('File Attachments', Attachment = ThisItem.Attachment.Attachment).Name & " </a>"
                    Tooltip: ="Click to view pdf / image on Sharepoint"
                    Width: =215
                    X: =26
                    Y: =69
                    ZIndex: =4

                DataCardKeyAttachment As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =true
                    Width: =107
                    Wrap: =false
                    X: =26
                    Y: =33
                    ZIndex: =5

                ButtonSaveToSp As Button:
                    ButtonType: ='Button.ButtonType'.Primary
                    DisplayMode: |
                        =//If(EditForm_PORequest.Mode = FormMode.New, DisplayMode.Disabled, DisplayMode.Edit)
                    Height: =32
                    OnSelect: |-
                        =// !!! TO DO !!!  ADD checks for filename validity and max file-path length
                        
                        
                        Set(
                            varFileName,
                            AddMediaButton1.FileName
                        );
                        Set(
                            varFileContent,
                            JSON(
                                UploadedImage1.Image,
                                JSONFormat.IncludeBinaryData
                            )
                        );
                        
                        //Save PRF and initiate approval: NOTE: this section added 03/05/23
                        //---------------------------------
                        SubmitForm(EditForm_PORequest);
                        UpdateContext({editMode: false, newMode: false}); //edit:line added 11/04
                        UpdateContext({edtFrmVsbl: false});
                        Set(CurrentItem, EditForm_PORequest.LastSubmit); //edit: next 2 lines added 26/04
                        Refresh('Purchase Order Requests');
                        //---------------------------------
                        
                        
                        Notify("Form saved and Uploading File to Sharepoint library (Operations/Documents/Site Rollout/Quotations/...)",NotificationType.Information);
                        
                        Set(
                            varBase64Only,
                            Mid(
                                varFileContent,
                                Find(
                                    ",",
                                    varFileContent
                                ) + 1,
                                Len(varFileContent) - Find(
                                    ",",
                                    varFileContent
                                ) - 1
                            )
                        );
                        Set(
                            varImageGUID,
                        //    SubmitForm(EditForm_PORequest);
                            UploadFileToSP.Run(
                                varFileName,
                                varBase64Only
                            ).imageguid
                        );
                        Patch(
                            'Purchase Order Requests',
                            CurrentItem,
                            {
                                Attachment: LookUp(
                                    'File Attachments',
                                    Attachment = GUID(varImageGUID)
                                )
                            }
                        );
                        UpdateContext({edtFrmVsbl: false});
                        Refresh('Purchase Order Requests');
                        Notify("...uploaded to library",NotificationType.Success)
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Upload"
                    Tooltip: ="Save PRF and upload attachment"
                    Width: =96
                    X: =363
                    Y: =120
                    ZIndex: =8

                GroupFileUpload As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =9

                    UploadedImage1 As image:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        Height: =82
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Image: |
                            =If(IsBlank(AddMediaButton1.Media), LookUp('File Attachments', Attachment = ThisItem.Attachment.Attachment).'Thumbnail URL', AddMediaButton1.Media)
                        ImagePosition: =ImagePosition.Fill
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        RadiusBottomLeft: =3
                        RadiusBottomRight: =3
                        RadiusTopLeft: =3
                        RadiusTopRight: =3
                        Tooltip: ="Upload quotation"
                        Width: =157
                        X: =330
                        Y: =9
                        ZIndex: =6

                    AddMediaButton1 As addMedia:
                        BorderColor: =RGBA(68, 70, 116, 1)
                        BorderStyle: =BorderStyle.None
                        ChangePictureText: ="Change File"
                        Color: =RGBA(68, 70, 116, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        Fill: =RGBA(224, 224, 237, 1)
                        Font: =Font.'Segoe UI'
                        Height: =82
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                        PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -50%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        Size: =10
                        Text: ="Tap or click to select file"
                        Tooltip: ="Upload quotation"
                        Width: =157
                        X: =330
                        Y: =9
                        ZIndex: =7

            "'Expense Type_DataCard1' As typedDataCard.pcfCoreComboBoxOptionSetMultiEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_expensetype"
                Default: =ThisItem.'Expense Type'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_expensetype")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =DataCardValue45.SelectedItems.Value
                Visible: =varCurrentTab = "Finance"
                Width: =543
                WidthFit: =false
                X: =0
                Y: =7
                ZIndex: =1

                DataCardKey53 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =10
                    ZIndex: =1

                DataCardValue45 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    IsSearchable: =false
                    Items: =Choices('Expense Type (Purchase Order Requests)')
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =419
                    X: =24
                    Y: =DataCardKey53.Y + DataCardKey53.Height + 4
                    ZIndex: =2

                ErrorMessage47 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue45.Y + DataCardValue45.Height
                    ZIndex: =3

                StarVisible47 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey53.Y
                    ZIndex: =4

            "'Classification Code_DataCard1' As typedDataCard.pcfCoreComboBoxOptionSetMultiEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_classificationcode"
                Default: =ThisItem.'Classification Code'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_classificationcode")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =DataCardValue44.SelectedItems.Value
                Visible: =varCurrentTab = "Finance"
                Width: =543
                WidthFit: =false
                X: =3
                Y: =7
                ZIndex: =1

                DataCardKey52 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =10
                    ZIndex: =1

                DataCardValue44 As combobox:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    ChevronBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                    ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                    ChevronFill: =RGBA(96, 94, 92, 1)
                    ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                    ChevronHoverFill: =RGBA(96, 94, 92, 1)
                    Color: =RGBA(37, 36, 35, 1)
                    DefaultSelectedItems: =Parent.Default
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayFields: =["Value"]
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =32
                    HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    IsSearchable: =false
                    Items: =Choices('Classification Code (Purchase Order Requests)')
                    PaddingLeft: =12
                    PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    SearchFields: =["Value"]
                    SearchItems: =[]
                    SelectionColor: =RGBA(37, 36, 35, 1)
                    SelectionFill: =RGBA(237, 235, 233, 1)
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =DataCardKey52.Y + DataCardKey52.Height + 4
                    ZIndex: =2

                ErrorMessage46 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue44.Y + DataCardValue44.Height
                    ZIndex: =3

                StarVisible46 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey52.Y
                    ZIndex: =4

            DataCard_Budgeted As typedDataCard.blankCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_budgeted"
                DisplayMode: =DisplayMode.Edit
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Visible: =varCurrentTab = "Finance"
                Width: =181
                WidthFit: =false
                X: =0
                Y: =8
                ZIndex: =1

                "Checkbox4 As 'Check box'":
                    Checked: =ThisItem.Budgeted
                    DisplayMode: =DisplayMode.Edit
                    Height: =33
                    Label: ="Budgeted"
                    OnChange: =false
                    OnCheck: |-
                        =Patch('Purchase Order Requests', 
                              ThisItem, 
                              { 
                               Budgeted: true
                              }
                        )
                    OnUncheck: |-
                        =Patch('Purchase Order Requests', 
                              ThisItem, 
                              { 
                               Budgeted: false
                              }
                        )
                    PCFTeamsTheme: =TeamsTheme.Default
                    Tooltip: ="Tick if budgeted, otherwise non-budgeted items"
                    Width: =103
                    X: =24
                    Y: =39
                    ZIndex: =1

            "'Budget Balance_DataCard1' As typedDataCard.pcfCoreCurrencyEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_budgetbalance"
                Default: =ThisItem.'Budget Balance'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_budgetbalance")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =76
                Required: =false
                Update: =Value(DataCardValue43.Text)
                Visible: =varCurrentTab = "Finance"
                Width: =724
                WidthFit: =false
                X: =1
                Y: =8
                ZIndex: =1

                DataCardKey50 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Budget Balance (RM)"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =10
                    ZIndex: =1

                DataCardValue43 As text:
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderThickness: =0
                    Color: =RGBA(37, 36, 35, 1)
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(200, 198, 196, 1)
                    DisabledFill: =RGBA(243, 242, 241, 1)
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(243, 242, 241, 1)
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Format: =TextFormat.Number
                    Height: =32
                    HintText: ="Enter Remaining budget"
                    HoverBorderColor: =RGBA(243, 242, 241, 1)
                    HoverColor: =RGBA(37, 36, 35, 1)
                    HoverFill: =RGBA(243, 242, 241, 1)
                    PaddingBottom: =4
                    PaddingRight: =12
                    PaddingTop: =0
                    PressedBorderColor: =RGBA(98, 100, 167, 1)
                    PressedColor: =RGBA(37, 36, 35, 1)
                    PressedFill: =RGBA(243, 242, 241, 1)
                    RadiusBottomLeft: =3
                    RadiusBottomRight: =3
                    RadiusTopLeft: =3
                    RadiusTopRight: =3
                    Size: =10.5
                    Tooltip: =Parent.DisplayName
                    Width: =225
                    X: =24
                    Y: =DataCardKey50.Y + DataCardKey50.Height + 4
                    ZIndex: =2

                ErrorMessage44 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue43.Y + DataCardValue43.Height
                    ZIndex: =3

                StarVisible44 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey50.Y
                    ZIndex: =4

            approvalTrail_DataCard1 As typedDataCard.pcfCoreTextualMultiLineEditCard:
                BorderColor: =RGBA(98, 100, 167, 1)
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =1
                DataField: ="cr4e3_approvaltrail"
                Default: =ThisItem.approvalTrail
                DisplayMode: =DisplayMode.View
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_approvaltrail")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =136
                Required: =false
                Update: =
                Visible: =varCurrentTab = "Approvals"
                Width: =1086
                WidthFit: =true
                X: =0
                Y: =11
                ZIndex: =1

                DataCardKey34 As Label:
                    AutoHeight: =true
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Approval Trail"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =10
                    ZIndex: =1

                "DataCardValue30 As 'Text box'":
                    AccessibleLabel: =Parent.DisplayName
                    DisplayMode: =DisplayMode.View
                    Font: =Font.'Courier New'
                    FontSize: =10.5
                    FontWeight: =FontWeight.Normal
                    Height: =186
                    Italic: =false
                    Mode: ="Multiline"
                    PCFTeamsTheme: =TeamsTheme.Default
                    Placeholder: ="--- approval info will appear here ---"
                    Required: =Parent.Required
                    Tooltip: ="Audit trail of completed approval steps"
                    Underlined: =false
                    Value: =Parent.Default
                    Width: =Parent.Width - 48
                    X: =25
                    Y: =50
                    ZIndex: =2

                ErrorMessage28 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue30.Y + DataCardValue30.Height
                    ZIndex: =3

                StarVisible28 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey34.Y
                    ZIndex: =4

            Remarks_DataCard1 As typedDataCard.pcfCoreTextualMultiLineEditCard:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_remarks"
                Default: =ThisItem.Remarks
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_remarks")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =140
                Required: =false
                Update: =DataCardValue8.Value
                Visible: =varCurrentTab = "General"
                Width: =362
                WidthFit: =false
                X: =4
                Y: =4
                ZIndex: =22

                DataCardKey11 As Label:
                    AutoHeight: =true
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="Justication / Remarks"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =475
                    Wrap: =true
                    X: =24
                    Y: =10
                    ZIndex: =1

                "DataCardValue8 As 'Text box'":
                    AccessibleLabel: =Parent.DisplayName
                    DisplayMode: =Parent.DisplayMode
                    FontSize: =10.5
                    Height: =96
                    Mode: ="Multiline"
                    PCFTeamsTheme: =TeamsTheme.Default
                    Required: =Parent.Required
                    SpellCheck: =true
                    Tooltip: ="Justification for purchase requisition or other remarks"
                    Value: =Parent.Default
                    Width: =315
                    X: =24
                    Y: =40
                    ZIndex: =2

                ErrorMessage10 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue8.Y + DataCardValue8.Height
                    ZIndex: =3

                StarVisible10 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey11.Y
                    ZIndex: =4

            "'POR Date_DataCard1' As typedDataCard.pcfCoreDateTimeEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_pordate"
                Default: =If( IsBlankOrError(ThisItem.'POR Date'), Today(), ThisItem.'POR Date')
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_pordate")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =true
                Update: =Date(Year(DateValue1.Value), Month(DateValue1.Value), Day(DateValue1.Value))
                Visible: =varCurrentTab = "General"
                Width: =181
                WidthFit: =false
                X: =0
                Y: =5
                ZIndex: =22

                DataCardKey2 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="PRF Raised Date"
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =18
                    ZIndex: =1

                "DateValue1 As 'Date picker'":
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    DisplayMode: =Parent.DisplayMode
                    Height: =32
                    PCFTeamsTheme: =TeamsTheme.Default
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =157
                    X: =24
                    Y: =DataCardKey2.Y + DataCardKey2.Height + 4
                    ZIndex: =2

                ErrorMessage1 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DateValue1.Y + DateValue1.Height
                    ZIndex: =6

                StarVisible1 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey2.Y
                    ZIndex: =7

            "'Delivery Date_DataCard1' As typedDataCard.pcfCoreDateTimeEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_deliverydate"
                Default: =If( IsBlankOrError(ThisItem.'Delivery Date'), Today(), ThisItem.'Delivery Date')
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_deliverydate")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =Date(Year(DateValue3.Value), Month(DateValue3.Value), Day(DateValue3.Value)) // + Time(Value(HourValue3.Selected.Value), Value(MinuteValue3.Selected.Value), Value(Second(DateValue3.Value)))
                Visible: =varCurrentTab = "General"
                Width: =181
                WidthFit: =false
                X: =1
                Y: =5
                ZIndex: =22

                DataCardKey8 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =18
                    ZIndex: =1

                "DateValue3 As 'Date picker'":
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    DisplayMode: =Parent.DisplayMode
                    Height: =32
                    InitialPickerDate: =
                    PCFTeamsTheme: =TeamsTheme.Default
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =DataCardKey8.Y + DataCardKey8.Height + 4
                    ZIndex: =2

                ErrorMessage7 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DateValue3.Y + DateValue3.Height
                    ZIndex: =6

                StarVisible7 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey8.Y
                    ZIndex: =7

            "'Service Order_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_serviceorder"
                Default: =ThisItem.'Service Order'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_serviceorder")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                MaxLength: =DataSourceInfo([@'Purchase Order Requests'], DataSourceInfo.MaxLength, "cr4e3_serviceorder")
                Required: =false
                Update: =DataCardValue7.Value
                Visible: =varCurrentTab = "Finance"
                Width: =362
                WidthFit: =false
                X: =0
                Y: =9
                ZIndex: =22

                DataCardKey10 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =26
                    ZIndex: =1

                "DataCardValue7 As 'Text box'":
                    AccessibleLabel: =Parent.DisplayName
                    DisplayMode: =Parent.DisplayMode
                    FontSize: =10.5
                    Height: =32
                    Mode: ="SingleLine"
                    PCFTeamsTheme: =TeamsTheme.Default
                    Required: =Parent.Required
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =DataCardKey10.Y + DataCardKey10.Height + 4
                    ZIndex: =2

                ErrorMessage9 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue7.Y + DataCardValue7.Height
                    ZIndex: =3

                StarVisible9 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey10.Y
                    ZIndex: =4

            "'Customer PO_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_customerpo"
                Default: =ThisItem.'Customer PO'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_customerpo")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                MaxLength: =DataSourceInfo([@'Purchase Order Requests'], DataSourceInfo.MaxLength, "cr4e3_customerpo")
                Required: =false
                Update: =DataCardValue5.Value
                Visible: =varCurrentTab = "Finance"
                Width: =362
                WidthFit: =false
                X: =2
                Y: =9
                ZIndex: =22

                DataCardKey6 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =159
                    Wrap: =true
                    X: =24
                    Y: =18
                    ZIndex: =1

                "DataCardValue5 As 'Text box'":
                    AccessibleLabel: =Parent.DisplayName
                    DisplayMode: =Parent.DisplayMode
                    FontSize: =10.5
                    Height: =32
                    Mode: ="SingleLine"
                    PCFTeamsTheme: =TeamsTheme.Default
                    Required: =Parent.Required
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =299
                    X: =24
                    Y: =DataCardKey6.Y + DataCardKey6.Height + 4
                    ZIndex: =2

                ErrorMessage5 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue5.Y + DataCardValue5.Height
                    ZIndex: =3

                StarVisible5 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey6.Y
                    ZIndex: =4

            "'Sales Order_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_salesorder"
                Default: =ThisItem.'Sales Order'
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_salesorder")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                MaxLength: =DataSourceInfo([@'Purchase Order Requests'], DataSourceInfo.MaxLength, "cr4e3_salesorder")
                Required: =false
                Update: =DataCardValue6.Value
                Visible: =varCurrentTab = "Finance"
                Width: =362
                WidthFit: =false
                X: =4
                Y: =9
                ZIndex: =22

                DataCardKey9 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =26
                    ZIndex: =1

                "DataCardValue6 As 'Text box'":
                    AccessibleLabel: =Parent.DisplayName
                    DisplayMode: =Parent.DisplayMode
                    FontSize: =10.5
                    Height: =32
                    Mode: ="SingleLine"
                    PCFTeamsTheme: =TeamsTheme.Default
                    Required: =Parent.Required
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =DataCardKey9.Y + DataCardKey9.Height + 4
                    ZIndex: =2

                ErrorMessage8 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DataCardValue6.Y + DataCardValue6.Height
                    ZIndex: =3

                StarVisible8 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey9.Y
                    ZIndex: =4

            "'Customer PO Date_DataCard1' As typedDataCard.pcfCoreDateTimeEditCard":
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="cr4e3_customerpodate"
                Default: =If( IsBlankOrError(ThisItem.'Customer PO Date'), Today(), ThisItem.'Customer PO Date')
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@'Purchase Order Requests'],DataSourceInfo.DisplayName,"cr4e3_customerpodate")
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                Required: =false
                Update: =Date(Year(DateValue2.Value), Month(DateValue2.Value), Day(DateValue2.Value))
                Visible: =varCurrentTab = "Finance"
                Width: =362
                WidthFit: =false
                X: =0
                Y: =10
                ZIndex: =22

                DataCardKey7 As Label:
                    AutoHeight: =false
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =22
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.DisplayName
                    Tooltip: =Parent.DisplayName
                    VerticalAlignment: =VerticalAlign.Bottom
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =18
                    ZIndex: =1

                "DateValue2 As 'Date picker'":
                    AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                    DisplayMode: =Parent.DisplayMode
                    Height: =32
                    InitialPickerDate: =
                    PCFTeamsTheme: =TeamsTheme.Default
                    ShowGoToToday: =true
                    Tooltip: =Parent.DisplayName
                    Value: =Parent.Default
                    Width: =Parent.Width - 48
                    X: =24
                    Y: =DataCardKey7.Y + DataCardKey7.Height + 4
                    ZIndex: =2

                ErrorMessage6 As Label:
                    AutoHeight: =true
                    Color: =Color.Red
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =9
                    Height: =30
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: =Parent.Error
                    Tooltip: =Parent.Error
                    Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                    Width: =Parent.Width - 48
                    Wrap: =true
                    X: =24
                    Y: =DateValue2.Y + DateValue2.Height
                    ZIndex: =6

                StarVisible6 As Label:
                    Alignment: =Align.Center
                    DisplayMode: =DisplayMode.Edit
                    Height: =20
                    PCFTeamsTheme: =TeamsTheme.Default
                    Text: ="*"
                    VerticalAlignment: =VerticalAlign.Bottom
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    X: =0
                    Y: =DataCardKey7.Y
                    ZIndex: =7

        ContainerTabBtns As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =varStyle.largeIconSize + 10
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowX: =LayoutOverflow.Scroll
            Width: =Parent.Width
            Y: =RectanglePrfHdr.Y + RectanglePrfHdr.Height - 7
            ZIndex: =4

            btn_General As Button:
                Alignment: =Align.Center
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderRadius: =7
                BorderStyle: =BorderStyle.Solid
                BorderThickness: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        0,
                        "Voa",
                        3,
                        "Finance",
                        3,
                        "Approvals",
                        3
                    )
                ButtonType: ='Button.ButtonType'.Primary
                DisplayMode: =DisplayMode.Edit
                FillColor: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        RGBA(98, 100, 167, 1),
                        "Voa",
                        RGBA(161, 162, 202, 1),
                        "Finance",
                        RGBA(161, 162, 202, 1),
                        "Approvals",
                        RGBA(161, 162, 202, 1)
                    )
                FontSize: =8
                Height: =45
                HoverFillColor: =RGBA(98, 100, 167, 1)
                LayoutMinHeight: =32
                LayoutMinWidth: =80
                OnSelect: =Set(varCurrentTab, "General")
                PressedFillColor: =RGBA(161, 162, 202, 1)
                Text: ="General"
                Width: =80
                X: =0
                Y: =0
                ZIndex: =1

            btn_Voa As Button:
                AlignInContainer: =AlignInContainer.Start
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderRadius: =7
                BorderStyle: =BorderStyle.Solid
                BorderThickness: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        3,
                        "Voa",
                        0,
                        "Finance",
                        3,
                        "Approvals",
                        3
                    )
                ButtonType: ='Button.ButtonType'.Primary
                DisplayMode: =DisplayMode.Edit
                FillColor: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        RGBA(161, 162, 202, 1),
                        "Voa",
                        RGBA(98, 100, 167, 1),
                        "Finance",
                        RGBA(161, 162, 202, 1),
                        "Approvals",
                        RGBA(161, 162, 202, 1)
                    )
                FontSize: =8
                Height: =45
                HoverFillColor: =RGBA(98, 100, 167, 1)
                LayoutMinHeight: =32
                LayoutMinWidth: =80
                OnSelect: =Set(varCurrentTab, "Voa")
                PressedFillColor: =RGBA(161, 162, 202, 1)
                Text: ="VOA / Quotation"
                Width: =80
                X: =0
                Y: =0
                ZIndex: =2

            btn_Finance As Button:
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderRadius: =7
                BorderStyle: =BorderStyle.Solid
                BorderThickness: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        3,
                        "Voa",
                        3,
                        "Finance",
                        0,
                        "Approvals",
                        3
                    )
                ButtonType: ='Button.ButtonType'.Primary
                DisplayMode: =DisplayMode.Edit
                FillColor: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        RGBA(161, 162, 202, 1),
                        "Voa",
                        RGBA(161, 161, 202, 1),
                        "Finance",
                        RGBA(98, 100, 167, 1),
                        "Approvals",
                        RGBA(161, 162, 202, 1)
                    )
                FontSize: =8
                Height: =45
                HoverFillColor: =RGBA(98, 100, 167, 1)
                LayoutMinHeight: =32
                LayoutMinWidth: =80
                OnSelect: =Set(varCurrentTab, "Finance")
                PressedFillColor: =RGBA(161, 162, 202, 1)
                Text: ="Finance"
                Width: =80
                X: =0
                Y: =0
                ZIndex: =3

            btn_Approvals As Button:
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderRadius: =7
                BorderStyle: =BorderStyle.Solid
                BorderThickness: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        3,
                        "Voa",
                        3,
                        "Finance",
                        3,
                        "Approvals",
                        0
                    )
                ButtonType: ='Button.ButtonType'.Primary
                DisplayMode: =DisplayMode.Edit
                FillColor: |-
                    =Switch(
                        varCurrentTab,
                        "General",
                        RGBA(161, 162, 202, 1),
                        "Voa",
                        RGBA(161, 162, 202, 1),
                        "Finance",
                        RGBA(161, 162, 202, 1),
                        "Approvals",
                        RGBA(98, 100, 167, 1)
                    )
                FontSize: =8
                Height: =45
                HoverFillColor: =RGBA(98, 100, 167, 1)
                LayoutMinHeight: =32
                LayoutMinWidth: =80
                OnSelect: =Set(varCurrentTab, "Approvals")
                PressedFillColor: =RGBA(161, 162, 202, 1)
                Text: ="Approvals"
                Width: =80
                X: =0
                Y: =0
                ZIndex: =4

        RectanglePrfHdr As rectangle:
            BorderColor: =RGBA(243, 242, 241, 1)
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(98, 100, 167, 1)
            Fill: =RGBA(98, 100, 167, 1)
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            Height: =40
            HoverFill: =RGBA(98, 100, 167, 1)
            PressedFill: =RGBA(98, 100, 167, 1)
            Width: =Parent.Width
            Y: =varStyle.topBarHeight
            ZIndex: =5

        LblPrfHeader As Label:
            Alignment: =Align.Center
            AutoHeight: =false
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.Edit
            FontSize: =12
            FontWeight: =FontWeight.Semibold
            Height: =40
            PCFTeamsTheme: =TeamsTheme.Default
            Text: ="Purchase Requisition Form"
            VerticalAlignment: =VerticalAlign.Middle
            Width: =260
            Wrap: =true
            X: =(Parent.Width - LblPrfHeader.Width)/2
            Y: =varStyle.topBarHeight
            ZIndex: =6

        TopBottomDivider1 As rectangle:
            BorderColor: =RGBA(243, 242, 241, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(200, 198, 196, 1)
            Fill: =varStyle.dividerFill
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            Height: =1
            HoverFill: =RGBA(98, 100, 167, 1)
            PressedFill: =RGBA(98, 100, 167, 1)
            Width: =Parent.Width
            Y: =TopBar_RightContainer1.Height
            ZIndex: =7

        TopBar_RightContainer1 As groupContainer:
            Height: =varStyle.topBarHeight
            Width: =Parent.Width
            ZIndex: =8

            TimerCancel1 As timer:
                BorderColor: =RGBA(98, 100, 167, 1)
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(200, 198, 196, 1)
                DisabledFill: =RGBA(243, 242, 241, 1)
                Duration: =200
                Fill: =RGBA(98, 100, 167, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =0
                HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                OnTimerEnd: =SetFocus(IconButton_Cancel1)
                PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                Size: =10.5
                Start: =Or(editMode, newMode)
                TabIndex: =-1
                Text: =""
                Visible: =false
                Width: =0
                ZIndex: =2

            TimerDeleteCancelled1 As timer:
                BorderColor: =RGBA(98, 100, 167, 1)
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(200, 198, 196, 1)
                DisabledFill: =RGBA(243, 242, 241, 1)
                Duration: =200
                Fill: =RGBA(98, 100, 167, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =0
                HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                OnTimerEnd: |-
                    =SetFocus(IconButton_Delete1); UpdateContext({deleteCancelled:false});
                PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                Size: =10.5
                Start: =deleteCancelled
                TabIndex: =-1
                Text: =""
                Visible: =false
                Width: =0
                ZIndex: =3

            IconButton_Back1 As icon.ChevronLeft:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.ChevronLeft
                OnSelect: |-
                    =UpdateContext({itemSelected:false})
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =0
                Tooltip: ="Back"
                Visible: =If(App.ActiveScreen.Size = ScreenSize.Small, And(!editMode, !newMode, !deleteMode), false)
                Width: =varStyle.largeIconSize
                X: =varStyle.topBarTitleLeftPadding
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =4

            IconButton_Delete1 As icon.Trash:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Trash
                OnSelect: |-
                    =UpdateContext({deleteMode:true, deleteCancelled:false, selectedRecord: Gallery_POR.Selected })
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =0
                Tooltip: ="Delete"
                Visible: =And(!editMode, !newMode, !deleteMode)
                Width: =varStyle.largeIconSize
                X: =IconButton_Edit1.X - varStyle.spaceBetweenIcons - Self.Width
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =5

            IconButton_Edit1 As icon.Edit:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Edit
                OnSelect: |-
                    =UpdateContext({selectedRecord: Gallery_POR.Selected, editMode:true});
                    UpdateContext({edtFrmVsbl: true});
                    NewForm(FormPorDetails)
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =0
                Tooltip: ="Edit PRF data"
                Visible: =And(!editMode, !newMode, !deleteMode)
                Width: =varStyle.largeIconSize
                X: =Parent.Width - Self.Width - varStyle.topBarTitleLeftPadding
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =6

            IconButton_Cancel1 As icon.Cancel:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: |-
                    =ResetForm(EditForm_PORequest);
                    UpdateContext({editMode: false, newMode: false});
                    UpdateContext({edtFrmVsbl: false})
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =0
                Tooltip: ="Cancel"
                Visible: =Or(editMode, newMode)
                Width: =varStyle.largeIconSize
                X: =IconButton_Accept1.X - varStyle.spaceBetweenIcons - Self.Width
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =7

            IconButton_Accept1 As icon.Check:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Check
                OnSelect: |-
                    =SubmitForm(EditForm_PORequest);
                    UpdateContext({edtFrmVsbl: false});
                    Refresh('Purchase Order Requests')
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =0
                Tooltip: ="Save record"
                Visible: =Or(editMode, newMode)
                Width: =varStyle.largeIconSize
                X: =Parent.Width - Self.Width - varStyle.topBarTitleLeftPadding
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =8

            IconButton_Home1 As icon.Home:
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Home
                OnSelect: =Navigate(ScrnHome)
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Visible: =ScrnPrchsOrdrRqst.Size > ScreenSize.Medium
                Width: =varStyle.largeIconSize
                X: =10
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =9

            IconButton_Refresh As icon.Trash:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Reload
                OnSelect: =Refresh('Purchase Order Requests')
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Rotation: =45
                TabIndex: =0
                Tooltip: ="Refresh PRF data"
                Visible: =And(!editMode, !newMode, !deleteMode)
                Width: =varStyle.largeIconSize
                X: =IconButton_Delete1 .X - varStyle.spaceBetweenIcons - Self.Width
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =10

            IconButton_Print As icon.Trash:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Print
                OnSelect: |-
                    =Set(CurrentItem, Gallery_POR.Selected);
                    Navigate(ScrnPoPrnt);
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Rotation: =45
                TabIndex: =0
                Tooltip: ="Print Purchase Doc"
                Visible: =And(!editMode, !newMode, !deleteMode)
                Width: =varStyle.largeIconSize
                X: =IconButton_Refresh.X - varStyle.spaceBetweenIcons - Self.Width
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =11

            IconExpand As icon.ExpandView:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.ExpandView
                OnSelect: |-
                    =UpdateContext({scrnSplit: varSpltHgh})
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Tooltip: ="Collapse line items view and show PRF"
                Visible: =scrnSplit = varSpltLw
                Width: =varStyle.largeIconSize
                X: =IconButton_Print.X - varStyle.spaceBetweenIcons - Self.Width
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =12

            IconCollapse As icon.CollapseView:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Color: =RGBA(98, 100, 167, 1)
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varStyle.focusBorderColor
                Height: =varStyle.largeIconSize
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.CollapseView
                OnSelect: |-
                    =UpdateContext({scrnSplit: varSpltLw})
                PaddingBottom: =varStyle.iconPadding
                PaddingLeft: =varStyle.iconPadding
                PaddingRight: =varStyle.iconPadding
                PaddingTop: =varStyle.iconPadding
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Tooltip: ="Collapse PRF and show line items"
                Visible: =scrnSplit = varSpltHgh
                Width: =varStyle.largeIconSize
                X: =IconButton_Print.X - varStyle.spaceBetweenIcons - Self.Width
                Y: =(Parent.Height -  Self.Height) / 2
                ZIndex: =13

        DeleteConfirmOverlay1 As groupContainer:
            Height: =Parent.Height
            Visible: =If(deleteMode, true, false)
            Width: =Parent.Width
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            ZIndex: =9

            TimerSetFocus1 As timer:
                BorderColor: =RGBA(98, 100, 167, 1)
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(200, 198, 196, 1)
                DisabledFill: =RGBA(243, 242, 241, 1)
                Duration: =If(LeftContainer1.Width = 0, 2500, 200)
                Fill: =RGBA(98, 100, 167, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =0
                HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                OnTimerEnd: =SetFocus(DeleteCancelBtn1)
                PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                Size: =10.5
                Start: =deleteMode
                TabIndex: =-1
                Text: =""
                Visible: =false
                Width: =0
                ZIndex: =1

            TimerShowDeleteText1 As timer:
                BorderColor: =RGBA(98, 100, 167, 1)
                BorderStyle: =BorderStyle.None
                DisabledBorderColor: =RGBA(243, 242, 241, 1)
                DisabledColor: =RGBA(200, 198, 196, 1)
                DisabledFill: =RGBA(243, 242, 241, 1)
                Duration: =200
                Fill: =RGBA(98, 100, 167, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =0
                HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(98, 100, 167, 1), -10%)
                OnTimerEnd: |-
                    =UpdateContext({deletePromptString:"Are you sure you want to delete this record?"})
                OnTimerStart: |-
                    =UpdateContext({deletePromptString:""})
                PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                Size: =10.5
                Start: =deleteMode
                TabIndex: =-1
                Text: =""
                Visible: =false
                Width: =0
                ZIndex: =2

            DeleteCancelBtn1 As button:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Fill: =RGBA(98, 100, 167, 1)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =32
                OnSelect: |-
                    =UpdateContext({deleteMode:false, deleteCancelled:true})
                RadiusBottomLeft: =3
                RadiusBottomRight: =3
                RadiusTopLeft: =3
                RadiusTopRight: =3
                Text: ="Cancel"
                Width: =96
                X: =(Parent.Width - (Self.Width * 2 + varStyle.iconPadding)) / 2
                Y: =DeleteText1.Y + DeleteText1.Height+varStyle.iconPadding
                ZIndex: =3

            DeleteConfirmBtn1 As button:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =varStyle.borderStyle
                Fill: =RGBA(98, 100, 167, 1)
                FocusedBorderColor: =varStyle.focusBorderColor
                FocusedBorderThickness: =varStyle.focusBorderThickness
                Height: =32
                OnSelect: |
                    =// Remove POR's matching line items first, so that POR can then be removed
                    // To DO !!! What to do if there are errors during delete ? !!!
                    
                    RemoveIf(
                        'Order Request Items',
                        'POR ID'.'Purchase Order Request' = selectedRecord.'Purchase Order Request'
                    );
                    Remove(
                        'Purchase Order Requests',
                        selectedRecord
                    );
                    If(
                        IsEmpty(
                            Errors(
                                'Purchase Order Requests',
                                selectedRecord
                            )
                        ),
                        UpdateContext(
                            {
                                CurrentItem: First('Purchase Order Requests'),
                                itemSelected: false,
                                editMode: false,
                                newMode: false,
                                deleteMode: false
                            }
                        )
                    );
                RadiusBottomLeft: =3
                RadiusBottomRight: =3
                RadiusTopLeft: =3
                RadiusTopRight: =3
                Text: ="Delete"
                Width: =96
                X: =(Parent.Width - (Self.Width * 2 + varStyle.iconPadding)) / 2 + DeleteCancelBtn1.Width + varStyle.iconPadding
                Y: =DeleteText1.Y + DeleteText1.Height+varStyle.iconPadding
                ZIndex: =4

            DeleteText1 As label:
                Align: =Align.Center
                Height: =120
                Live: =Live.Assertive
                Text: =deletePromptString
                Width: =Min(350, Parent.Width * 0.8) 
                X: =(Parent.Width - Self.Width) / 2
                Y: =232
                ZIndex: =5

